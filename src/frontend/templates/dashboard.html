{% extends "base.html" %}
{% block title %}
    Dashboard - Waskita
{% endblock title %}
{% block page_title %}
    Dashboard
{% endblock page_title %}
{% block breadcrumb %}
    <li class="breadcrumb-item">
        <a href="{{ url_for("main.dashboard") }}">Home</a>
    </li>
    <li class="breadcrumb-item active">Dashboard</li>
{% endblock breadcrumb %}
{% block content %}
    <!-- Info boxes -->
    <section aria-labelledby="stats-heading">
        <h2 id="stats-heading" class="sr-only">Data Statistics</h2>
        <div class="row">
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box" role="region" aria-labelledby="upload-stats">
                    <span class="info-box-icon bg-info elevation-1" aria-hidden="true"><i class="fas fa-upload"></i></span>
                    <div class="info-box-content">
                        <span class="info-box-text" id="upload-stats">{{ t('Uploaded Data') }}</span>
                        <span class="info-box-number" aria-label="Total uploaded data: {{ stats.total_raw_upload or 0 }}">{{ stats.total_raw_upload or 0 }}</span>
                    </div>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box mb-3" role="region" aria-labelledby="scraping-stats">
                    <span class="info-box-icon bg-success elevation-1" aria-hidden="true"><i class="fas fa-spider"></i></span>
                    <div class="info-box-content">
                        <span class="info-box-text" id="scraping-stats">{{ t('Scraped Data') }}</span>
                        <span class="info-box-number" aria-label="Total scraped data: {{ stats.total_raw_scraper or 0 }}">{{ stats.total_raw_scraper or 0 }}</span>
                    </div>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box mb-3" role="region" aria-labelledby="cleaned-stats">
                    <span class="info-box-icon bg-warning elevation-1" aria-hidden="true"><i class="fas fa-broom"></i></span>
                    <div class="info-box-content">
                        <span class="info-box-text" id="cleaned-stats">{{ t('Cleaned Data') }}</span>
                        <span class="info-box-number" aria-label="Total cleaned data: {{ (stats.total_clean_upload or 0) + (stats.total_clean_scraper or 0) }}">{{ (stats.total_clean_upload or 0) + (stats.total_clean_scraper or 0) }}</span>
                    </div>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box mb-3" role="region" aria-labelledby="classified-stats">
                    <span class="info-box-icon bg-danger elevation-1" aria-hidden="true"><i class="fas fa-brain"></i></span>
                    <div class="info-box-content">
                        <span class="info-box-text" id="classified-stats">{{ t('Classified') }}</span>
                        <span class="info-box-number" aria-label="Total classified data: {{ stats.total_classified or 0 }}">{{ stats.total_classified or 0 }}</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Actions (Toolbar) -->
    <section aria-labelledby="quick-actions-heading" class="mb-4">
        <h2 id="quick-actions-heading" class="sr-only">Quick Actions</h2>
        <div class="row">
            <div class="col-6 col-md-3 mb-3 mb-md-0">
                <a href="{{ url_for("dataset.upload_file") }}" class="btn btn-outline-primary btn-block btn-action-small shadow-sm">
                    <i class="fas fa-upload mr-2"></i> Upload Data
                </a>
            </div>
            <div class="col-6 col-md-3 mb-3 mb-md-0">
                <a href="{{ url_for("scraper.index") }}" class="btn btn-outline-success btn-block btn-action-small shadow-sm">
                    <i class="fas fa-spider mr-2"></i> Data Scraping
                </a>
            </div>
            <div class="col-6 col-md-3">
                <a href="{{ url_for("dataset.management_table") }}" class="btn btn-outline-warning btn-block btn-action-small shadow-sm">
                    <i class="fas fa-table mr-2"></i> Manage Dataset
                </a>
            </div>
            <div class="col-6 col-md-3">
                <a href="{{ url_for("classification.index") }}" class="btn btn-outline-danger btn-block btn-action-small shadow-sm">
                    <i class="fas fa-brain mr-2"></i> Classification
                </a>
            </div>
        </div>
    </section>

    <!-- Charts Row -->
    <section aria-labelledby="charts-heading" class="mb-4">
        <h2 id="charts-heading" class="sr-only">Charts and Data Visualization</h2>
        <div class="row mb-4">
            <!-- Data Source Chart -->
            <div class="col-md-6">
                <div class="card h-100">
                    <header class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1" aria-hidden="true"></i>
                            Data Source Distribution
                        </h3>
                    </header>
                    <div class="card-body">
                        <div class="chart-container" style="position: relative; height: 250px;">
                            <canvas id="dataSourceChart" 
                                    role="img" 
                                    aria-label="Pie chart showing data source distribution between upload and scraping"
                                    aria-describedby="data-source-description">
                            </canvas>
                        </div>
                        <div id="data-source-description" class="sr-only">
                            Pie chart displaying comparison of data from upload ({{ stats.total_raw_upload or 0 }}) and scraping ({{ stats.total_raw_scraper or 0 }})
                        </div>
                    </div>
                </div>
            </div>
            <!-- Classification Results Chart -->
            <div class="col-md-6">
                <div class="card h-100">
                    <header class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-bar mr-1" aria-hidden="true"></i>
                            Classification Results
                        </h3>
                    </header>
                    <div class="card-body">
                        <div class="chart-container" style="position: relative; height: 250px;">
                            <canvas id="classificationChart" 
                                    role="img" 
                                    aria-label="Bar chart showing classification results for radical and non-radical content"
                                    aria-describedby="classification-description">
                            </canvas>
                        </div>
                        <div id="classification-description" class="sr-only">
                            Bar chart displaying classification results: Radical ({{ stats.total_radikal or 0 }}) and Non-Radical ({{ stats.total_non_radikal or 0 }})
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Platform Distribution and System Status -->
        <div class="row">
            <div class="col-md-8 d-flex">
                <div class="card w-100">
                    <header class="card-header d-flex justify-content-between align-items-center">
                        <h3 class="card-title">
                            <i class="fas fa-chart-line mr-1" aria-hidden="true"></i>
                            Social Media Platform Distribution
                        </h3>
                    </header>
                    <div class="card-body">
                        <div class="chart-container" style="position: relative; height: 400px; display: flex; justify-content: center; align-items: center;">
                            <canvas id="platformChart" 
                                    role="img" 
                                    aria-label="Area chart showing total data per platform"
                                    aria-describedby="platform-description">
                            </canvas>
                        </div>
                        <div id="platform-description" class="sr-only">
                            Stacked area chart displaying data amount from: Twitter, TikTok, Facebook, and Upload
                        </div>
                    </div>
                </div>
            </div>
            <!-- System Status & Recent Activity -->
            <div class="col-md-4 d-flex flex-column">
                 <!-- Status Card -->
                 <div class="card mb-3">
                    <header class="card-header">
                        <h3 class="card-title font-weight-bold">
                            <i class="fas fa-server mr-2"></i>System Status
                        </h3>
                    </header>
                    <div class="card-body">
                        <div class="progress-group mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span class="font-weight-bold">Word2Vec Model</span>
                                <span class="font-weight-bold">{{ model_status.word2vec }}</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: {{ '100' if model_status.word2vec == 'Loaded' else '0' }}%"></div>
                            </div>
                        </div>
                        <div class="progress-group mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span class="font-weight-bold">Classification Models</span>
                                <span class="font-weight-bold">{{ model_status.active_models_count }}/7</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: {{ (model_status.active_models_count / 7 * 100) }}%"></div>
                            </div>
                        </div>
                        <div class="progress-group">
                            <div class="d-flex justify-content-between mb-1">
                                <span class="font-weight-bold">Database</span>
                                <span class="font-weight-bold">{{ model_status.database }}</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: {{ '100' if model_status.database == 'Connected' else '0' }}%"></div>
                            </div>
                        </div>
                    </div>
                 </div>

                 <!-- Activity Card -->
                 <div class="card flex-grow-1">
                    <header class="card-header">
                        <h3 class="card-title font-weight-bold">
                            <i class="fas fa-history mr-2"></i>Recent Activities
                        </h3>
                    </header>
                    <div class="card-body p-0 d-flex flex-column">
                        <div class="activity-list p-3 flex-grow-1">
                            {% if recent_activities %}
                                {% for activity in recent_activities[:5] %}
                                    <div class="d-flex align-items-center mb-2 pb-2 border-bottom activity-item">
                                        <div class="mr-3 flex-shrink-0">
                                            {% if 'login' in activity.title.lower() %}
                                                <i class="fas fa-sign-in-alt text-success fa-lg"></i>
                                            {% elif 'logout' in activity.title.lower() %}
                                                <i class="fas fa-sign-out-alt text-warning fa-lg"></i>
                                            {% else %}
                                                <i class="fas {{ activity.icon }} text-{{ activity.color }} fa-lg"></i>
                                            {% endif %}
                                        </div>
                                        <div class="flex-grow-1 overflow-hidden" style="line-height: 1.2;">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <div class="text-truncate mr-2" style="max-width: 75%;">
                                                    <span class="font-weight-bold" style="font-size: 0.85rem;">{{ activity.title }}</span>
                                                    <span class="text-muted ml-1" style="font-size: 0.8rem;">- {{ activity.description }}</span>
                                                </div>
                                                <small class="text-muted text-nowrap flex-shrink-0" style="font-size: 0.7rem;">{{ activity.time }}</small>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <div class="text-center text-muted py-3">
                                    <p class="mb-0 small">No activities yet</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                 </div>
            </div>
        </div>
    </section>
{% endblock content %}

{% block scripts %}
<script>
// Function to update dashboard statistics
function updateDashboardStats() {
    fetch('/dashboard/stats')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            
            
            // Update info boxes
            document.querySelector('#upload-stats').nextElementSibling.textContent = data.total_raw_upload || 0;
            document.querySelector('#scraping-stats').nextElementSibling.textContent = data.total_raw_scraper || 0;
            document.querySelector('#cleaned-stats').nextElementSibling.textContent = (data.total_clean_upload || 0) + (data.total_clean_scraper || 0);
            document.querySelector('#classified-stats').nextElementSibling.textContent = data.total_classified || 0;

            // Update charts
            if (window.dataSourceChart) {
                window.dataSourceChart.data.datasets[0].data = [
                    data.total_raw_upload || 0,
                    data.total_raw_scraper || 0
                ];
                window.dataSourceChart.update();
            }

            if (window.classificationChart) {
                window.classificationChart.data.datasets[0].data = [
                    data.total_radikal || 0,
                    data.total_non_radikal || 0
                ];
                window.classificationChart.update();
            }

            if (window.platformChart && data.platform_stats) {
                window.platformChart.data.datasets[0].data = [
                    data.platform_stats.twitter_scraper || 0,
                    data.platform_stats.tiktok_scraper || 0,
                    data.platform_stats.facebook_scraper || 0,
                    data.platform_stats.total_upload || 0
                ];
                window.platformChart.update();
            }
        })
        .catch(error => {
            console.error('Error updating dashboard stats:', error);
            // Show error message to user
            Swal.fire({
                icon: 'error',
                title: 'Failed to update statistics',
                text: 'An error occurred while updating dashboard statistics',
                timer: 3000,
                timerProgressBar: true
            });
        });
}

// Update stats every 30 seconds
setInterval(updateDashboardStats, 30000);

// Update stats when page loads
document.addEventListener('DOMContentLoaded', updateDashboardStats);
</script>
{% endblock scripts %}

{% block extra_css %}
<style>
/* Compact Activity List Styling */
.activity-list {
    max-height: 400px;
    overflow-y: auto;
}

.activity-item {
    border-left: 3px solid transparent;
    padding-left: 0.5rem;
    transition: all 0.2s ease;
}

.activity-item:hover {
    border-left-color: #007bff;
    background-color: #f8f9fa;
    border-radius: 0.25rem;
}

.activity-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f8f9fa;
    border-radius: 50%;
    flex-shrink: 0;
}

.activity-icon i {
    font-size: 0.875rem;
}

.activity-title {
    font-size: 0.875rem;
    line-height: 1.2;
    color: #495057;
}

.activity-description {
    font-size: 0.75rem;
    line-height: 1.3;
    margin-bottom: 0.25rem !important;
}

.activity-date {
    font-size: 0.7rem;
    font-weight: 500;
}

/* Scrollbar styling */
.activity-list::-webkit-scrollbar {
    width: 4px;
}

.activity-list::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 2px;
}

.activity-list::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 2px;
}

.activity-list::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
}

/* Quick Actions Button Styling */
.btn-action-small {
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
}

.btn-action {
    height: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.btn-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.btn-action i {
    font-size: 1.5rem;
    margin-bottom: 5px;
}

/* Equal height cards */
.card.h-100 {
    min-height: 350px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .activity-list {
        max-height: 300px;
    }
    
    .activity-icon {
        width: 28px;
        height: 28px;
    }
    
    .activity-title {
        font-size: 0.8rem;
    }
    
    .activity-description {
        font-size: 0.7rem;
    }
    
    .btn-action {
        height: 70px;
        font-size: 0.8rem;
    }
    
    .btn-action i {
        font-size: 1.3rem;
    }
    
    .card.h-100 {
        min-height: auto;
        margin-bottom: 20px;
    }
}

/* Dark Mode Overrides */
body.dark-mode .card {
    background-color: #343a40;
    border-color: #454d55;
}
body.dark-mode .card-header {
    background-color: #343a40;
    border-bottom-color: #454d55;
}
body.dark-mode .info-box {
    background-color: #343a40;
    color: #fff;
}
body.dark-mode .info-box-text, body.dark-mode .info-box-number {
    color: #fff;
}
body.dark-mode .activity-item:hover {
    background-color: #454d55;
}
body.dark-mode .activity-icon {
    background-color: #454d55;
}
body.dark-mode .activity-title {
    color: #e9ecef;
}
body.dark-mode .text-muted {
    color: #adb5bd !important;
}
body.dark-mode .btn-outline-primary, body.dark-mode .btn-outline-success, 
body.dark-mode .btn-outline-warning, body.dark-mode .btn-outline-danger {
    color: #fff;
    border-color: #6c757d;
}
body.dark-mode .btn-outline-primary:hover, body.dark-mode .btn-outline-success:hover, 
body.dark-mode .btn-outline-warning:hover, body.dark-mode .btn-outline-danger:hover {
    background-color: #454d55;
}

/* Font Consistency */
h2 { font-size: 1.5rem !important; font-weight: 600; }
h3.card-title { font-size: 1.1rem !important; font-weight: 600; }
.info-box-text { font-size: 0.9rem !important; }
.info-box-number { font-size: 1.5rem !important; font-weight: 700; }
.btn-action-small { font-size: 0.9rem !important; }
.activity-title { font-size: 0.9rem !important; font-weight: 600; }
.activity-description { font-size: 0.8rem !important; }
</style>
{% endblock extra_css %}

{% block extra_js %}
    <script>
$(document).ready(function() {
    // Ensure Chart.js is loaded
    if (typeof Chart === 'undefined') {
        return;
    }
    {% set ps = platform_stats if platform_stats is defined else {} %}
    
    // Helper to get CSS variable value
    function getStyle(variable) {
        return getComputedStyle(document.body).getPropertyValue(variable).trim();
    }

    // Helper for chart colors
    function getChartColors() {
        const isDark = document.body.classList.contains('dark-mode');
        return {
            textColor: getStyle('--body-color'),
            gridColor: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)',
            borderColor: getStyle('--card-bg')
        };
    }

    // Update charts function
    function updateCharts() {
        const colors = getChartColors();
        
        // Update DataSource Chart
        if (window.dataSourceChart) {
            window.dataSourceChart.data.datasets[0].borderColor = colors.borderColor;
            window.dataSourceChart.options.plugins.legend.labels.color = colors.textColor;
            window.dataSourceChart.update();
        }
        
        // Update Classification Chart
        if (window.classificationChart) {
            window.classificationChart.options.scales.x.ticks.color = colors.textColor;
            window.classificationChart.options.scales.x.grid.color = colors.gridColor;
            window.classificationChart.options.scales.y.ticks.color = colors.textColor;
            window.classificationChart.options.scales.y.grid.color = colors.gridColor;
            window.classificationChart.update();
        }
        
        // Update Platform Chart
        if (window.platformChart) {
            window.platformChart.options.scales.x.ticks.color = colors.textColor;
            window.platformChart.options.scales.x.grid.color = colors.gridColor;
            window.platformChart.options.scales.y.ticks.color = colors.textColor;
            window.platformChart.options.scales.y.grid.color = colors.gridColor;
            window.platformChart.options.plugins.legend.labels.color = colors.textColor;
            window.platformChart.update();
        }
    }

    // Listen to theme changes
    window.addEventListener('themeChanged', function() {
        updateCharts();
    });

    const initialColors = getChartColors();
    
    // Data Source Chart
    const dataSourceCtx = document.getElementById('dataSourceChart').getContext('2d');
    window.dataSourceChart = new Chart(dataSourceCtx, {
        type: 'doughnut',
        data: {
            labels: ['Upload', 'Scraping'],
            datasets: [{
                data: [{{ stats.total_raw_upload or 0 }}, {{ stats.total_raw_scraper or 0 }}],
                backgroundColor: ['#17a2b8', '#28a745'],
                borderWidth: 2,
                borderColor: initialColors.borderColor
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: initialColors.textColor
                    }
                }
            }
        }
    });
    
    // Classification Results Chart
    const classificationCtx = document.getElementById('classificationChart').getContext('2d');
    window.classificationChart = new Chart(classificationCtx, {
        type: 'bar',
        data: {
            labels: ['Radical', 'Non-Radical'],
            datasets: [{
                label: 'Classification Results',
                data: [{{ stats.total_radikal or 0 }}, {{ stats.total_non_radikal or 0 }}],
                backgroundColor: ['#dc3545', '#28a745'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: initialColors.textColor },
                    grid: { color: initialColors.gridColor }
                },
                x: {
                    ticks: { color: initialColors.textColor },
                    grid: { color: initialColors.gridColor }
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });
    
    // Platform Distribution Chart
    const platformCtx = document.getElementById('platformChart').getContext('2d');
    
    // Create gradient
    const gradientFill = platformCtx.createLinearGradient(0, 0, 0, 400);
    gradientFill.addColorStop(0, 'rgba(94, 114, 228, 0.5)'); // Primary color
    gradientFill.addColorStop(1, 'rgba(94, 114, 228, 0.0)');

    window.platformChart = new Chart(platformCtx, {
        type: 'line',
        data: {
            labels: ['Twitter', 'TikTok', 'Facebook', 'Data Upload'],
            datasets: [{
                label: 'Total Data',
                data: [{{ ps.twitter_scraper or 0 }}, {{ ps.tiktok_scraper or 0 }}, {{ ps.facebook_scraper or 0 }}, {{ ps.total_upload or 0 }}],
                borderColor: '#5e72e4',
                backgroundColor: gradientFill,
                borderWidth: 3,
                pointBackgroundColor: ['#1DA1F2', '#000000', '#4267B2', '#6c757d'],
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#5e72e4',
                pointRadius: 6,
                pointHoverRadius: 8,
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleFont: { size: 13 },
                    bodyFont: { size: 13 },
                    padding: 10,
                    cornerRadius: 4,
                    displayColors: true,
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y;
                            }
                            return label;
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        drawBorder: false,
                        color: 'rgba(0, 0, 0, 0.05)'
                    },
                    ticks: {
                        precision: 0
                    },
                    stacked: true
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            },
            interaction: {
                intersect: false,
                mode: 'index',
            },
        }
    });
    
    // Auto refresh every 30 seconds
    setInterval(function() {
        location.reload();
    }, 30000);
});

// Function to show more activities
function showMoreActivities() {
    // Create modal to show all activities
    const modal = `
        <div class="modal fade" id="allActivitiesModal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-clock mr-2"></i>All Recent Activities
                        </h5>
                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="activity-list-full" style="max-height: 400px; overflow-y: auto;">
                            {% for activity in recent_activities %}
                                <div class="activity-item d-flex align-items-start mb-3">
                                    <div class="activity-icon mr-3">
                                        <i class="fas {{ activity.icon }} text-{{ activity.color }}"></i>
                                    </div>
                                    <div class="activity-content flex-grow-1">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <h6 class="activity-title mb-1 font-weight-bold">{{ activity.title }}</h6>
                                            <small class="text-muted ml-2">{{ activity.time }}</small>
                                        </div>
                                        <p class="activity-description mb-1 text-muted">{{ activity.description }}</p>
                                        <small class="activity-date text-primary">{{ activity.date }}</small>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Remove existing modal if any
    $('#allActivitiesModal').remove();
    
    // Add modal to body and show
    $('body').append(modal);
    $('#allActivitiesModal').modal('show');
}
    </script>
{% endblock extra_js %}
