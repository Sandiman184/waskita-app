services:
  # Override untuk service web agar berjalan dengan konfigurasi development
  web:
    env_file:
      - ../.env.docker
    environment:
      - FLASK_CONFIG=development
      - DOTENV_OVERRIDE=False
      - DISABLE_MODEL_LOADING=True

  nginx:
    # Build image khusus untuk development (HTTP-only)
    build:
      context: .
      dockerfile: Dockerfile.nginx.dev
    # Override ports: pakai 8080 di host untuk lokal (hard-code untuk hindari variabel env)
    ports:
      - "8080:80"
    # Gunakan konfigurasi HTTP-only
    environment:
      - ENABLE_SSL=false
      - NGINX_SERVER_NAME=localhost
    volumes:
      - ../static:/var/www/static
    # Jangan gunakan volume mounts dari base compose file

  # Override untuk service database agar memakai .env.docker
  db:
    env_file:
      - ../.env.docker